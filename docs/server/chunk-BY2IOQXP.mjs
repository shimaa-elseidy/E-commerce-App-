import './polyfills.server.mjs';
import{a as N}from"./chunk-CX6CO7AG.mjs";import{a as L,b as p,c as V,d as k,f as A,g as q,h as R,i as I,j as M,l as B}from"./chunk-LONSOCWI.mjs";import"./chunk-E3EVZCWB.mjs";import{k as y,l as T}from"./chunk-GLGEAX7W.mjs";import{j as E}from"./chunk-OBCDUCAI.mjs";import{Hb as s,Jb as S,Ob as b,Qa as l,Rb as v,Y as f,aa as F,fb as m,hb as c,jb as P,ka as g,la as w,lb as d,pb as r,qb as n,rb as _,ub as h,yb as C,zb as u}from"./chunk-XICHFWCK.mjs";import"./chunk-VVCT4QZE.mjs";var x=(o,a)=>({"is-valid":o,"is-invalid":a});function D(o,a){o&1&&(r(0,"div",2),s(1," Reset code sent successfully to your email. "),n())}function G(o,a){o&1&&(r(0,"small",12),s(1," Email Is Required "),n())}function O(o,a){o&1&&(r(0,"small",12),s(1," Enter Valid Email"),n())}function $(o,a){if(o&1&&(r(0,"div",7),m(1,G,2,0,"small",12)(2,O,2,0,"small",12),n()),o&2){let e,i,t=u(2);l(),d(1,(e=t.forgotPasswordForm.get("email"))!=null&&e.getError("required")?1:-1),l(),d(2,(i=t.forgotPasswordForm.get("email"))!=null&&i.getError("email")?2:-1)}}function j(o,a){o&1&&_(0,"span",9)}function z(o,a){if(o&1){let e=h();r(0,"section",0)(1,"h2",1),s(2,"Forgot Password"),n(),m(3,D,2,0,"div",2),r(4,"small"),s(5,"Enter your email address below and we'll send you a code to reset your password."),n(),r(6,"form",3),C("ngSubmit",function(){g(e);let t=u();return w(t.forgotpassword())}),r(7,"div",4)(8,"label",5),s(9,"Email Address"),n(),_(10,"input",6),n(),r(11,"div"),m(12,$,3,2,"div",7),n(),r(13,"button",8),s(14,"Send Reset Code "),m(15,j,1,0,"span",9),n()(),r(16,"div",10)(17,"a",11),s(18,"Back to Login"),n()()()}if(o&2){let e,i,t=u();l(3),d(3,t.isAlertVisible?3:-1),l(3),c("formGroup",t.forgotPasswordForm),l(4),c("ngClass",v(6,x,!((e=t.forgotPasswordForm.get("email"))!=null&&e.errors)&&(((e=t.forgotPasswordForm.get("email"))==null?null:e.touched)||((e=t.forgotPasswordForm.get("email"))==null?null:e.dirty)),((e=t.forgotPasswordForm.get("email"))==null?null:e.errors)&&(((e=t.forgotPasswordForm.get("email"))==null?null:e.touched)||((e=t.forgotPasswordForm.get("email"))==null?null:e.dirty)))),l(2),d(12,(i=t.forgotPasswordForm.get("email"))!=null&&i.errors&&((i=t.forgotPasswordForm.get("email"))!=null&&i.touched||(i=t.forgotPasswordForm.get("email"))!=null&&i.dirty)?12:-1),l(),c("disabled",t.forgotPasswordForm.invalid||t.Loading),l(2),d(15,t.Loading==!0?15:-1)}}function U(o,a){o&1&&(r(0,"small",12),s(1," Code Is Required "),n())}function W(o,a){o&1&&(r(0,"small",12),s(1," Enter Valid Code"),n())}function H(o,a){if(o&1&&(r(0,"div",7),m(1,U,2,0,"small",12)(2,W,2,0,"small",12),n()),o&2){let e,i,t=u(2);l(),d(1,(e=t.sendCodeForm.get("resetCode"))!=null&&e.getError("required")?1:-1),l(),d(2,(i=t.sendCodeForm.get("resetCode"))!=null&&i.getError("pattern")?2:-1)}}function J(o,a){o&1&&_(0,"span",9)}function K(o,a){if(o&1&&(r(0,"div",18),s(1),n()),o&2){let e=u(2);l(),S(" ",e.isCodeInvalid," ")}}function Q(o,a){if(o&1){let e=h();r(0,"section",0)(1,"h2",1),s(2,"Enter Verification Code"),n(),r(3,"small"),s(4,"We've sent a verification code to your email. Please enter it below to verify your identity and reset your password."),n(),r(5,"form",3),C("ngSubmit",function(){g(e);let t=u();return w(t.sendCode())}),r(6,"div",4)(7,"label",13),s(8,"Verification Code"),n(),_(9,"input",14),n(),r(10,"div"),m(11,H,3,2,"div",7),n(),r(12,"button",15),s(13,"Verify Code "),m(14,J,1,0,"span",9),n()(),r(15,"div",16)(16,"small"),s(17,"Didn't receive a code?"),n(),r(18,"span",17),C("click",function(){g(e);let t=u();return w(!t.Loading&&!t.resendMsg&&t.resendCode())}),s(19," Resend Code "),n(),m(20,K,2,1,"div",18),n(),r(21,"div",10)(22,"a",11),s(23,"Back to Login"),n()()()}if(o&2){let e,i,t=u();l(5),c("formGroup",t.sendCodeForm),l(4),c("ngClass",v(8,x,!((e=t.sendCodeForm.get("resetCode"))!=null&&e.errors)&&(((e=t.sendCodeForm.get("resetCode"))==null?null:e.touched)||((e=t.sendCodeForm.get("resetCode"))==null?null:e.dirty)),((e=t.sendCodeForm.get("resetCode"))==null?null:e.errors)&&(((e=t.sendCodeForm.get("resetCode"))==null?null:e.touched)||((e=t.sendCodeForm.get("resetCode"))==null?null:e.dirty)))),l(2),d(11,(i=t.sendCodeForm.get("resetCode"))!=null&&i.errors&&((i=t.sendCodeForm.get("resetCode"))!=null&&i.touched||(i=t.sendCodeForm.get("resetCode"))!=null&&i.dirty)?11:-1),l(),c("disabled",t.sendCodeForm.invalid||t.Loading),l(2),d(14,t.Loading==!0?14:-1),l(4),P("disabled",t.Loading||t.resendMsg),l(2),d(20,t.isCodeInvalid?20:-1)}}function X(o,a){o&1&&(r(0,"small",19),s(1,"success..."),n())}function Y(o,a){o&1&&(r(0,"small",12),s(1," New password Is Required "),n())}function Z(o,a){o&1&&(r(0,"small",12),s(1," Enter Valid Password"),n())}function ee(o,a){if(o&1&&(r(0,"div",23),m(1,Y,2,0,"small",12)(2,Z,2,0,"small",12),n()),o&2){let e,i,t=u(2);l(),d(1,(e=t.resetNewPasswordForm.get("newPassword"))!=null&&e.getError("required")?1:-1),l(),d(2,(i=t.resetNewPasswordForm.get("newPassword"))!=null&&i.getError("pattern")?2:-1)}}function te(o,a){o&1&&_(0,"span",9)}function oe(o,a){if(o&1){let e=h();r(0,"section",0)(1,"h2",1),s(2,"Reset Password"),n(),m(3,X,2,0,"small",19),r(4,"small"),s(5,"Enter your new password below."),n(),r(6,"form",3),C("ngSubmit",function(){g(e);let t=u();return w(t.resetPassword())}),r(7,"div",4)(8,"label",5),s(9,"Email Address"),n(),_(10,"input",20),n(),r(11,"div",4)(12,"label",21),s(13,"New Password"),n(),_(14,"input",22),r(15,"div"),m(16,ee,3,2,"div",23),n()(),r(17,"button",15),s(18,"Reset Password "),m(19,te,1,0,"span",9),n()(),r(20,"div",10)(21,"a",11),s(22,"Back to Login"),n()()()}if(o&2){let e,i,t=u();l(3),d(3,t.success?3:-1),l(3),c("formGroup",t.resetNewPasswordForm),l(8),c("ngClass",v(6,x,!((e=t.resetNewPasswordForm.get("newPassword"))!=null&&e.errors)&&(((e=t.resetNewPasswordForm.get("newPassword"))==null?null:e.touched)||((e=t.resetNewPasswordForm.get("newPassword"))==null?null:e.dirty)),((e=t.resetNewPasswordForm.get("newPassword"))==null?null:e.errors)&&(((e=t.resetNewPasswordForm.get("newPassword"))==null?null:e.touched)||((e=t.resetNewPasswordForm.get("newPassword"))==null?null:e.dirty)))),l(2),d(16,(i=t.resetNewPasswordForm.get("newPassword"))!=null&&i.errors&&((i=t.resetNewPasswordForm.get("newPassword"))!=null&&i.touched||(i=t.resetNewPasswordForm.get("newPassword"))!=null&&i.dirty)?16:-1),l(),c("disabled",t.resetNewPasswordForm.invalid||t.Loading),l(2),d(19,t.Loading==!0?19:-1)}}var ue=(()=>{class o{constructor(){this._AuthServiceService=f(N),this._FormBuilder=f(M),this._Router=f(y),this.step=1,this.Loading=!1,this.isAlertVisible=!1,this.resendMsg=!1,this.success=!1,this.isCodeInvalid="",this.forgotPasswordForm=this._FormBuilder.group({email:[null,[p.required,p.email]]}),this.sendCodeForm=this._FormBuilder.group({resetCode:[null,[p.required,p.pattern(/^[0-9]{6}$/)]]}),this.resetNewPasswordForm=this._FormBuilder.group({email:[null,[p.required,p.email]],newPassword:[null,[p.required,p.pattern(/^\w{6,}$/)]]})}forgotpassword(){this.forgotPasswordForm.markAllAsTouched(),this.forgotPasswordForm.get("email")?.value;this.resetNewPasswordForm.get("email")?.patchValue(this.forgotPasswordForm.get("email")?.value),this.forgotPasswordForm.valid&&(this.Loading=!0,this.forgotpasswordSub=this._AuthServiceService.forgotPassword(this.forgotPasswordForm.value).subscribe({next:e=>{e.statusMsg=="success"&&(this.Loading=!1,this.isAlertVisible=!0,setTimeout(()=>{this.step=2},1e3))},error:e=>{console.log(e),this.Loading=!1}}))}sendCode(){this.sendCodeForm.markAllAsTouched(),this.sendCodeForm.valid?(this.Loading=!0,this.isCodeInvalid="",this.sendCodeSub=this._AuthServiceService.sendcode(this.sendCodeForm.value).subscribe({next:e=>{this.Loading=!1,e.status==="Success"&&(this.success=!0,setTimeout(()=>{this.success=!1,this.step=3},3e3))},error:e=>{this.Loading=!1,this.isCodeInvalid="The entered code is invalid. Please check and try again."}})):this.isCodeInvalid="Please enter a valid code."}resendCode(){this.sendCodeForm.valid?(this.Loading=!0,this.sendCodeSub=this._AuthServiceService.sendcode(this.sendCodeForm.value).subscribe({next:e=>{this.Loading=!1,e.status==="Success"&&(this.success=!0,setTimeout(()=>{},3e3))},error:e=>{this.Loading=!1,this.isCodeInvalid="Failed to resend the code, please try again."}})):this.sendCodeForm.markAllAsTouched()}resetPassword(){this.resetNewPasswordForm.markAllAsTouched(),this.resetNewPasswordForm.valid&&(this.Loading=!0,this.resetPasswordSub=this._AuthServiceService.resetPassword(this.resetNewPasswordForm.value).subscribe({next:e=>{this.Loading=!1,console.log(e),localStorage.setItem("userToken",e.token),this._AuthServiceService.saveUserToken(),setTimeout(()=>{this._Router.navigate(["/home"])},1e3)},error:e=>{console.log(e),this.Loading=!1}}))}ngOnDestroy(){this.forgotpasswordSub?.unsubscribe(),this.sendCodeSub?.unsubscribe(),this.resetPasswordSub?.unsubscribe()}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275cmp=F({type:o,selectors:[["app-forgot-password"]],standalone:!0,features:[b],decls:3,vars:1,consts:[[1,"bg-main-light","rounded-4","my-2","p-2","shadow"],[1,"text-main","fw-bolder","fs-4","my-3"],["role","alert",1,"alert","alert-success","mx-auto","w-75","text-center","text-main","mt-3","p-1","rounded-5"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","email",1,"form-label"],["type","email","id","email","placeholder","Enter your email...","required","","formControlName","email",1,"form-control","rounded-5",3,"ngClass"],[1,"alert","alert-danger","mx-auto","w-25","text-center","mt-2","p-0"],["type","submit",1,"btn","btn-main","btn-sm","w-100","rounded-5",3,"disabled"],["role","status","aria-hidden","true",1,"fas","fa-spinner","fa-spin"],[1,"text-center","mt-3"],["routerLink","/login",1,"text-decoration-none"],[1,"m-0"],["for","verification-code",1,"form-label"],["type","text","id","verification-code","placeholder","Enter the code...","required","","formControlName","resetCode",1,"form-control","rounded-5",3,"ngClass"],["type","submit",1,"btn","btn-main","w-100","btn-sm","rounded-5",3,"disabled"],[1,"text-center","mt-3","ms-2"],[1,"customm-link",3,"click"],[1,"alert","alert-danger","mt-2","p-0","mx-auto","text-center","rounded-5","w-75"],[1,"alert","alert-success","fw-bold","mx-auto","w-75","text-center","mt-1","p-0","rounded-4"],["readonly","","type","email","id","email","placeholder","Enter your email...","required","","formControlName","email",1,"form-control","rounded-5"],["for","new-password",1,"form-label"],["type","password","id","new-password","placeholder","Enter your new password...","required","","formControlName","newPassword",1,"form-control","rounded-5","text-muted",3,"ngClass"],[1,"alert","alert-danger","mx-auto","w-25","text-center","mt-1","p-0"]],template:function(i,t){i&1&&m(0,z,19,9,"section",0)(1,Q,24,11)(2,oe,23,9),i&2&&d(0,t.step==1?0:t.step==2?1:t.step==3?2:-1)},dependencies:[B,A,L,V,k,I,q,R,T,E],styles:[".customm-link[_ngcontent-%COMP%]{display:inline-block;color:#11bd11;font-size:16px;cursor:pointer;transition:color .3s ease,transform .3s ease}.customm-link[_ngcontent-%COMP%]:hover{color:#11bd11;transform:scale(1.1)}.customm-link[_ngcontent-%COMP%]:active{transform:scale(.95)}.customm-link.disabled[_ngcontent-%COMP%]{color:#ccc;pointer-events:none;cursor:not-allowed;opacity:.6}"]})}}return o})();export{ue as ForgotPasswordComponent};
